# Story 4.6: 요약/태그 수동 편집 기능

## Status
Ready for Review

## Story
**As a** 사용자,
**I want** AI가 생성한 요약이나 태그를 수동으로 편집할 수 있겠습니다,
**so that** AI 결과가 만족스럽지 않을 때 직접 수정하거나 개선할 수 있습니다.

## Acceptance Criteria
1. 기존 AI 요약을 클릭하여 인라인 편집 가능
2. 기존 AI 태그를 클릭하여 인라인 편집 가능
3. 편집 중 저장/취소 버튼 제공
4. 편집 완료 시 변경사항 즉시 반영
5. 편집 취소 시 원본 내용 복원
6. 편집 중 다른 기능 사용 제한 (로딩 상태 표시)
7. 편집 권한은 노트 소유자에게만 부여

## Tasks / Subtasks
- [x] 요약 인라인 편집 기능 구현 (AC: 1, 3, 4, 5)
  - [x] 요약 텍스트 클릭 시 편집 모드 활성화
  - [x] 편집 모드에서 텍스트 입력 및 저장/취소 버튼 표시
  - [x] 저장 시 변경사항 즉시 반영
  - [x] 취소 시 원본 내용 복원
- [x] 태그 인라인 편집 기능 구현 (AC: 2, 3, 4, 5)
  - [x] 태그 클릭 시 편집 모드 활성화
  - [x] 편집 모드에서 태그 텍스트 수정 및 저장/취소 버튼 표시
  - [x] 저장 시 변경사항 즉시 반영
  - [x] 취소 시 원본 내용 복원
- [x] 편집 상태 관리 구현 (AC: 6)
  - [x] 편집 중 다른 기능 사용 제한
  - [x] 편집 중 로딩 상태 표시
  - [x] 편집 완료 후 정상 상태 복원
- [x] 권한 검증 구현 (AC: 7)
  - [x] 노트 소유자만 편집 가능하도록 검증
  - [x] 권한 없는 사용자에게 편집 버튼 숨김
- [x] 사용자 경험 개선
  - [x] 편집 모드 진입/종료 애니메이션
  - [x] 키보드 단축키 지원 (Enter: 저장, Escape: 취소)
  - [x] 편집 중 자동 저장 기능 (선택적)

## Dev Notes
- 인라인 편집을 위해 contentEditable 또는 별도 입력 컴포넌트 사용 고려
- 편집 상태 관리를 위한 상태 관리 로직 필요
- 기존 AI 생성 결과와 수동 편집 결과를 구분할 수 있는 표시 필요
- 편집 히스토리 관리 (선택적 기능)

## Testing
- 요약 편집 기능 테스트
- 태그 편집 기능 테스트
- 편집 취소 기능 테스트
- 권한 검증 테스트
- 편집 상태 관리 테스트

## Dev Agent Record

### Agent Model Used
Claude 3.5 Sonnet (Dev Agent)

### Debug Log References
- 인라인 편집 기능 구현: InlineEdit 공통 컴포넌트 생성 및 NoteSummary, NoteTags 컴포넌트에 적용
- 서버 액션 추가: updateSummaryAction, updateTagsAction 구현
- 편집 상태 관리: 키보드 단축키, 외부 클릭 처리, 로딩 상태 관리
- 테스트 작성: InlineEdit 컴포넌트 및 편집 기능 테스트 작성

### Completion Notes List
- ✅ InlineEdit 공통 컴포넌트 생성 (인라인 편집, 키보드 단축키, 접근성 지원)
- ✅ updateSummaryAction 서버 액션 구현 (요약 수동 편집)
- ✅ updateTagsAction 서버 액션 구현 (태그 수동 편집)
- ✅ NoteSummary 컴포넌트에 인라인 편집 기능 추가
- ✅ NoteTags 컴포넌트에 인라인 편집 기능 추가
- ✅ 편집 상태 관리 및 사용자 경험 개선
- ✅ 포괄적인 단위 테스트 작성 (InlineEdit: 16개 테스트 통과)
- ✅ 기존 컴포넌트 테스트 유지 (NoteSummary: 12개, NoteTags: 17개 테스트 통과)

### File List
- `components/ui/inline-edit.tsx` - 인라인 편집 공통 컴포넌트
- `lib/actions/ai.ts` - 요약/태그 수동 편집 서버 액션 추가
- `components/notes/note-summary.tsx` - 요약 인라인 편집 기능 추가
- `components/notes/note-tags.tsx` - 태그 인라인 편집 기능 추가
- `__tests__/components/ui/inline-edit.test.tsx` - InlineEdit 컴포넌트 테스트
- `__tests__/lib/actions/ai-edit.test.ts` - 편집 서버 액션 테스트

### Change Log
- 2024-12-19: 스토리 4.6 구현 완료 - 요약/태그 수동 편집 기능
