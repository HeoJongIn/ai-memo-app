# Story 2.1: 노트 생성 (제목 + 본문)

## Status
Ready for Review

## Story
**As a** 사용자,
**I want** 제목과 본문을 입력하여 새로운 노트를 생성할 수 있도록 하겠습니다,
**so that** 아이디어와 정보를 체계적으로 기록하고 관리할 수 있습니다.

## Acceptance Criteria
1. 사용자가 노트 제목을 입력할 수 있는 필드가 제공되어야 합니다
2. 사용자가 노트 본문을 입력할 수 있는 텍스트 영역이 제공되어야 합니다
3. 노트 생성 시 현재 로그인한 사용자의 ID가 자동으로 연결되어야 합니다
4. 노트 저장 시 데이터베이스에 정상적으로 저장되어야 합니다
5. 노트 생성 성공 시 사용자에게 피드백이 제공되어야 합니다
6. 노트 생성 실패 시 적절한 에러 메시지가 표시되어야 합니다
7. 반응형 디자인으로 모바일과 데스크톱에서 모두 사용 가능해야 합니다

## Tasks / Subtasks
- [x] Task 1: 노트 생성 UI 컴포넌트 구현 (AC: 1, 2, 7)
  - [x] Subtask 1.1: 노트 생성 폼 컴포넌트 생성
  - [x] Subtask 1.2: 제목 입력 필드 구현 (shadcn/ui Input 컴포넌트 사용)
  - [x] Subtask 1.3: 본문 입력 영역 구현 (textarea 또는 에디터)
  - [x] Subtask 1.4: 저장 버튼 구현 (shadcn/ui Button 컴포넌트 사용)
  - [x] Subtask 1.5: 반응형 레이아웃 적용
- [x] Task 2: 노트 생성 서버 액션 구현 (AC: 3, 4)
  - [x] Subtask 2.1: createNote 서버 액션 함수 구현
  - [x] Subtask 2.2: 사용자 인증 상태 확인 로직 추가
  - [x] Subtask 2.3: 입력 데이터 유효성 검증 구현
  - [x] Subtask 2.4: Drizzle ORM을 사용한 데이터베이스 저장 로직 구현
- [x] Task 3: 에러 처리 및 사용자 피드백 구현 (AC: 5, 6)
  - [x] Subtask 3.1: 성공 시 토스트 메시지 표시
  - [x] Subtask 3.2: 에러 발생 시 에러 메시지 표시
  - [x] Subtask 3.3: 로딩 상태 표시 구현
- [x] Task 4: 테스트 작성 및 검증
  - [x] Subtask 4.1: 노트 생성 컴포넌트 단위 테스트 작성
  - [x] Subtask 4.2: 서버 액션 함수 테스트 작성
  - [x] Subtask 4.3: 통합 테스트 작성

## Dev Notes

### 이전 스토리 인사이트
- 스토리 2.0에서 DrizzleORM 환경이 완전히 설정됨
- 데이터베이스 스키마(notes 테이블)가 정의되어 있음
- 기본 CRUD 함수 템플릿이 lib/actions/notes.ts에 준비됨
- 사용자 스코프 기반 보안이 구현됨

### 데이터 모델
- **notes 테이블 스키마:** id, user_id, title, content, created_at, updated_at [Source: architecture.md#2]
- **필수 필드:** user_id (자동 설정), title, content
- **자동 필드:** id (UUID), created_at, updated_at (타임스탬프)

### API 명세
- **서버 액션:** createNote(title: string, content: string) [Source: architecture.md#4]
- **인증 요구사항:** 로그인한 사용자만 접근 가능
- **권한 스코프:** 사용자 ID 스코프로 소유자만 생성 가능 [Source: architecture.md#3]

### 컴포넌트 명세
- **UI 프레임워크:** shadcn/ui + Tailwind CSS [Source: architecture.md#1]
- **사용할 컴포넌트:** Input, Button, Card, Form
- **반응형 디자인:** 모바일 우선 접근 방식

### 파일 위치
- **노트 생성 페이지:** `/app/notes/create/page.tsx` (새로 생성)
- **노트 생성 컴포넌트:** `/components/notes/create-note-form.tsx` (새로 생성)
- **서버 액션:** `/lib/actions/notes.ts` (기존 파일 수정)
- **테스트 파일:** `/__tests__/components/notes/create-note-form.test.tsx` (새로 생성)

### 기술적 제약사항
- **프레임워크:** Next.js App Router 사용 [Source: architecture.md#1]
- **서버 로직:** Server Actions으로 구현 [Source: architecture.md#1]
- **데이터베이스:** Supabase Postgres + Drizzle ORM [Source: architecture.md#1]
- **인증:** Supabase Auth API 사용 [Source: architecture.md#1]

### Testing
- **테스트 프레임워크:** Jest (기존 설정 활용)
- **테스트 파일 위치:** `__tests__/` 디렉토리
- **테스트 대상:** 컴포넌트 렌더링, 사용자 상호작용, 서버 액션 호출, 에러 처리
- **테스트 표준:** 각 컴포넌트와 함수에 대한 단위 테스트 작성 필수

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2024-12-19 | 1.0 | 초기 스토리 생성 | Scrum Master |

## Dev Agent Record

### Agent Model Used
Claude Sonnet 4 (2024-12-19)

### Debug Log References
- 노트 생성 UI 컴포넌트 구현 완료
- 서버 액션 및 사용자 인증 로직 구현 완료
- 토스트 메시지 시스템 구현 완료
- 테스트 파일 작성 완료

### Completion Notes List
- app/notes/create/page.tsx: 노트 생성 페이지 컴포넌트 생성
- components/notes/create-note-form.tsx: 노트 생성 폼 컴포넌트 구현 (shadcn/ui 사용)
- components/ui/toast.tsx: 토스트 알림 시스템 구현
- lib/actions/notes.ts: createNoteAction 서버 액션 함수 추가 (사용자 인증 및 유효성 검증 포함)
- app/layout.tsx: ToastProvider 추가 및 메타데이터 업데이트
- __tests__/components/notes/create-note-form.test.tsx: 컴포넌트 단위 테스트 작성
- __tests__/lib/actions/notes-create.test.ts: 서버 액션 테스트 작성
- 모든 Acceptance Criteria 충족 확인
- 반응형 디자인 적용 완료
- 사용자 피드백 시스템 구현 완료

### File List
- app/notes/create/page.tsx (새로 생성)
- components/notes/create-note-form.tsx (새로 생성)
- components/ui/toast.tsx (새로 생성)
- lib/actions/notes.ts (수정 - createNoteAction 함수 추가)
- app/layout.tsx (수정 - ToastProvider 추가, 메타데이터 업데이트)
- __tests__/components/notes/create-note-form.test.tsx (새로 생성)
- __tests__/lib/actions/notes-create.test.ts (새로 생성)

## QA Results
*QA 에이전트가 완료된 스토리 구현을 검토한 결과가 기록됩니다*
